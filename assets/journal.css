/*
 * TECTONIQ - Scientific Journal Theme
 * =====================================
 * 
 * Design Philosophy:
 * - Cold white paper background (not cream)
 * - Charcoal text for readability
 * - Subtle pencil-like dividers
 * - Journal typography (serif headings, clean body)
 * - Minimal, calm, clinical aesthetic
 * 
 * Customization Hints:
 * - Font family: Search for "font-family" and adjust serif/sans-serif choices
 * - Divider intensity: Adjust opacity in .journal-divider (currently 0.15)
 * - Accent color: Update --accent-color variable (currently #5a6c7d)
 * 
 * Version: 1.0
 * Date: 2025-12-12
 */

/* ============================================================================
   COLOR SYSTEM (Do not invent alternatives)
   ============================================================================ */

:root {
    /* Base colors - cold paper white */
    --paper-white: #FFFFFF;
    --paper-bg: #FAFAFA;
    
    /* Text colors - charcoal hierarchy */
    --text-primary: #2B2B2B;
    --text-secondary: #4A4A4A;
    --text-muted: #6B6B6B;
    --text-light: #8B8B8B;
    
    /* Borders & dividers - subtle pencil-like */
    --border-light: #E0E0E0;
    --border-medium: #CCCCCC;
    --divider-pencil: rgba(0, 0, 0, 0.12);
    
    /* Accent - muted, clinical (used sparingly) */
    --accent-color: #5a6c7d;
    --accent-light: #7a8c9d;
    
    /* Status colors - quiet, non-distracting */
    --status-green: #4a7c59;
    --status-yellow: #b8860b;
    --status-red: #a24545;
    
    /* Status backgrounds - very subtle */
    --status-green-bg: #f0f7f4;
    --status-yellow-bg: #fffbf0;
    --status-red-bg: #fff5f5;
    
    /* Spacing & layout */
    --max-content-width: 900px;
    --spacing-xs: 0.5rem;
    --spacing-sm: 1rem;
    --spacing-md: 1.5rem;
    --spacing-lg: 2rem;
    --spacing-xl: 3rem;
}

/* ============================================================================
   GLOBAL BASE (AGGRESSIVE BACKGROUND UNIFICATION)
   ============================================================================ */

/* Force single background color across entire app */
html,
body,
.stApp,
[data-testid="stAppViewContainer"],
[data-testid="stHeader"],
.main,
.main .block-container,
section[data-testid="stSidebar"] > div:first-child {
    background-color: var(--paper-white) !important;
}

/* Remove any cream/gray frames */
[data-testid="stAppViewContainer"] > section:first-child {
    background-color: var(--paper-white) !important;
}

/* Main content area */
.main .block-container {
    max-width: var(--max-content-width) !important;
    padding-left: var(--spacing-md) !important;
    padding-right: var(--spacing-md) !important;
    padding-top: var(--spacing-lg) !important;
    padding-bottom: var(--spacing-xl) !important;
}

/* Ensure no background bleed in containers */
div[data-testid="stVerticalBlock"],
div[data-testid="stHorizontalBlock"],
div[class*="css-"] {
    background-color: transparent !important;
}

/* ============================================================================
   TYPOGRAPHY SYSTEM (Journal-like, calm)
   ============================================================================ */

/* Import fonts */
@import url('https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@400;700&family=Inter:wght@400;500;600&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Material+Icons');

/* Headings - serif for journal feel */
h1, h2, h3, h4, h5, h6 {
    font-family: 'Libre Baskerville', 'Georgia', serif !important;
    color: var(--text-primary) !important;
    font-weight: 700 !important;
    letter-spacing: -0.02em !important;
    line-height: 1.3 !important;
    margin-top: var(--spacing-lg) !important;
    margin-bottom: var(--spacing-sm) !important;
}

h1 {
    font-size: 2rem !important;
}

h2 {
    font-size: 1.5rem !important;
}

h3 {
    font-size: 1.25rem !important;
}

h4, h5, h6 {
    font-size: 1rem !important;
}

/* Body text - clean sans-serif */
p, div, label, span, input, textarea, li, td, th {
    font-family: 'Inter', 'Helvetica Neue', sans-serif !important;
    color: var(--text-secondary) !important;
    line-height: 1.6 !important;
}

/* Comfortable reading size */
p {
    font-size: 1rem !important;
    margin-bottom: var(--spacing-sm) !important;
}

/* Caption/small text */
.stCaption, [data-testid="stCaption"], small {
    font-size: 0.875rem !important;
    color: var(--text-muted) !important;
    line-height: 1.5 !important;
}

/* ============================================================================
   PENCIL DIVIDER (Subtle, low contrast)
   ============================================================================ */

/* Horizontal rules */
hr, .journal-divider {
    border: none !important;
    height: 1px !important;
    background: linear-gradient(
        to right,
        transparent 0%,
        var(--divider-pencil) 10%,
        var(--divider-pencil) 90%,
        transparent 100%
    ) !important;
    margin: var(--spacing-lg) 0 !important;
    opacity: 0.6 !important;
}

/* Markdown horizontal rules */
[data-testid="stMarkdownContainer"] hr {
    border: none !important;
    height: 1px !important;
    background: var(--divider-pencil) !important;
    margin: var(--spacing-md) 0 !important;
}

/* ============================================================================
   CARDS & CONTAINERS (Minimal borders, subtle shadows)
   ============================================================================ */

/* Remove heavy backgrounds */
div[data-testid="stVerticalBlock"],
div[data-testid="stHorizontalBlock"] {
    background-color: transparent !important;
}

/* Metrics/Cards */
div[data-testid="stMetric"],
div[data-testid="column"] > div {
    background-color: var(--paper-white) !important;
    border: 1px solid var(--border-light) !important;
    border-radius: 2px !important;
    padding: var(--spacing-md) !important;
    box-shadow: 0 1px 3px rgba(0,0,0,0.04) !important;
}

/* Metric values */
div[data-testid="stMetric"] [data-testid="stMetricValue"] {
    font-size: 1.75rem !important;
    font-weight: 600 !important;
    color: var(--text-primary) !important;
}

/* Metric labels */
div[data-testid="stMetric"] [data-testid="stMetricLabel"] {
    font-size: 0.875rem !important;
    color: var(--text-muted) !important;
    text-transform: uppercase !important;
    letter-spacing: 0.05em !important;
}

/* ============================================================================
   TABLES (Journal-style, clean and scannable)
   ============================================================================ */

/* Table container */
div[data-testid="stDataFrame"],
div[data-testid="stTable"] {
    border: 1px solid var(--border-light) !important;
    border-radius: 2px !important;
    overflow: hidden !important;
}

/* Table header */
table thead {
    background-color: var(--paper-bg) !important;
    border-bottom: 2px solid var(--border-medium) !important;
}

table thead th {
    font-family: 'Inter', sans-serif !important;
    font-weight: 600 !important;
    font-size: 0.875rem !important;
    color: var(--text-primary) !important;
    text-transform: uppercase !important;
    letter-spacing: 0.05em !important;
    padding: var(--spacing-sm) !important;
    text-align: left !important;
    border-bottom: 1px solid var(--border-medium) !important;
}

/* Table body */
table tbody td {
    font-size: 0.9375rem !important;
    color: var(--text-secondary) !important;
    padding: var(--spacing-sm) !important;
    border-bottom: 1px solid var(--border-light) !important;
}

/* Subtle zebra striping */
table tbody tr:nth-child(even) {
    background-color: var(--paper-bg) !important;
}

table tbody tr:hover {
    background-color: rgba(0, 0, 0, 0.02) !important;
}

/* Numeric columns - right align */
table tbody td:nth-child(n+2) {
    text-align: right !important;
}

/* ============================================================================
   BUTTONS (AGGRESSIVE NEUTRALIZATION - Print-era UI, minimal fill)
   ============================================================================ */

/* All buttons base style - FORCE NEUTRAL APPEARANCE */
button:not([class*="collapsedControl"]),
.stButton > button,
button[kind="primary"],
button[kind="secondary"],
button[data-testid="baseButton-primary"],
button[data-testid="baseButton-secondary"],
.stButton button,
[data-testid="stFormSubmitButton"] button {
    font-family: 'Inter', sans-serif !important;
    font-weight: 500 !important;
    font-size: 0.9375rem !important;
    letter-spacing: 0.02em !important;
    border-radius: 3px !important;
    padding: 0.5rem 1.25rem !important;
    transition: all 0.15s ease !important;
    border: 1px solid var(--border-medium) !important;
    background-color: var(--paper-white) !important;
    color: var(--text-primary) !important;
    cursor: pointer !important;
    /* KILL ALL BLUE */
    background-image: none !important;
    box-shadow: none !important;
}

button:hover:not([class*="collapsedControl"]) {
    border-color: var(--text-secondary) !important;
    background-color: var(--paper-bg) !important;
}

/* OVERRIDE: Primary buttons should NOT be blue - neutralize them */
button[kind="primary"],
button[data-testid="baseButton-primary"],
.stButton > button[kind="primary"] {
    background-color: var(--paper-white) !important;
    border-color: var(--border-medium) !important;
    color: var(--text-primary) !important;
    /* Force override any Streamlit primary styling */
    background-image: none !important;
}

button[kind="primary"]:hover,
button[data-testid="baseButton-primary"]:hover {
    background-color: var(--paper-bg) !important;
    border-color: var(--text-secondary) !important;
    color: var(--text-primary) !important;
}

/* Secondary button - same as primary (all neutral) */
button[kind="secondary"],
button[data-testid="baseButton-secondary"] {
    background-color: var(--paper-white) !important;
    border: 1px solid var(--border-medium) !important;
    color: var(--text-primary) !important;
}

button[kind="secondary"]:hover,
button[data-testid="baseButton-secondary"]:hover {
    background-color: var(--paper-bg) !important;
    border-color: var(--text-secondary) !important;
}

/* Form submit buttons - also neutral */
[data-testid="stFormSubmitButton"] button {
    background-color: var(--paper-white) !important;
    border: 1px solid var(--border-medium) !important;
    color: var(--text-primary) !important;
}

[data-testid="stFormSubmitButton"] button:hover {
    background-color: var(--paper-bg) !important;
    border-color: var(--text-secondary) !important;
}

/* ============================================================================
   EXPANDERS (Clean, understated, REDUCED CHROME)
   ============================================================================ */

div[data-testid="stExpander"] {
    background-color: var(--paper-white) !important;
    border: 1px solid var(--border-light) !important;
    border-radius: 2px !important;
    margin-bottom: var(--spacing-md) !important;
    /* Remove any default padding/margins */
    box-shadow: none !important;
}

div[data-testid="stExpander"] summary {
    font-family: 'Inter', sans-serif !important;
    font-weight: 500 !important;
    color: var(--text-primary) !important;
    padding: var(--spacing-sm) var(--spacing-md) !important;
    cursor: pointer !important;
    transition: background-color 0.15s ease !important;
    background-color: var(--paper-white) !important;
}

div[data-testid="stExpander"] summary:hover {
    background-color: var(--paper-bg) !important;
}

div[data-testid="stExpander"] div[data-testid="stExpanderDetails"] {
    padding: var(--spacing-md) !important;
    border-top: 1px solid var(--border-light) !important;
    background-color: var(--paper-white) !important;
}

/* Remove expander icons if they render as text */
div[data-testid="stExpander"] summary::marker {
    content: "" !important;
}

div[data-testid="stExpander"] summary::-webkit-details-marker {
    display: none !important;
}

/* ============================================================================
   ALERTS & STATUS MESSAGES (Calm, reduced vertical space)
   ============================================================================ */

/* Success messages */
div[data-testid="stAlert"][data-baseweb="notification"][kind="success"],
.stSuccess {
    background-color: var(--status-green-bg) !important;
    border-left: 3px solid var(--status-green) !important;
    border-radius: 2px !important;
    padding: var(--spacing-sm) var(--spacing-md) !important;
    margin: var(--spacing-xs) 0 !important;
}

div[data-testid="stAlert"][kind="success"] [data-testid="stMarkdownContainer"] {
    color: var(--status-green) !important;
}

/* Info messages */
div[data-testid="stAlert"][kind="info"],
.stInfo {
    background-color: var(--paper-bg) !important;
    border-left: 3px solid var(--accent-color) !important;
    border-radius: 2px !important;
    padding: var(--spacing-sm) var(--spacing-md) !important;
    margin: var(--spacing-xs) 0 !important;
}

div[data-testid="stAlert"][kind="info"] [data-testid="stMarkdownContainer"] {
    color: var(--accent-color) !important;
}

/* Warning messages */
div[data-testid="stAlert"][kind="warning"],
.stWarning {
    background-color: var(--status-yellow-bg) !important;
    border-left: 3px solid var(--status-yellow) !important;
    border-radius: 2px !important;
    padding: var(--spacing-sm) var(--spacing-md) !important;
    margin: var(--spacing-xs) 0 !important;
}

div[data-testid="stAlert"][kind="warning"] [data-testid="stMarkdownContainer"] {
    color: var(--status-yellow) !important;
}

/* Error messages */
div[data-testid="stAlert"][kind="error"],
.stError {
    background-color: var(--status-red-bg) !important;
    border-left: 3px solid var(--status-red) !important;
    border-radius: 2px !important;
    padding: var(--spacing-sm) var(--spacing-md) !important;
    margin: var(--spacing-xs) 0 !important;
}

div[data-testid="stAlert"][kind="error"] [data-testid="stMarkdownContainer"] {
    color: var(--status-red) !important;
}

/* ============================================================================
   INPUT CONTROLS (Clean, minimal)
   ============================================================================ */

/* Text inputs */
input[type="text"],
input[type="number"],
input[type="email"],
input[type="password"],
textarea {
    font-family: 'Inter', sans-serif !important;
    font-size: 0.9375rem !important;
    color: var(--text-primary) !important;
    border: 1px solid var(--border-medium) !important;
    border-radius: 2px !important;
    padding: 0.5rem 0.75rem !important;
    background-color: var(--paper-white) !important;
    transition: border-color 0.15s ease !important;
}

input:focus,
textarea:focus {
    border-color: var(--accent-color) !important;
    outline: none !important;
}

/* Selectbox */
div[data-baseweb="select"] {
    border: 1px solid var(--border-medium) !important;
    border-radius: 2px !important;
}

/* Slider */
div[data-testid="stSlider"] [data-baseweb="slider"] {
    color: var(--accent-color) !important;
}

/* ============================================================================
   SIDEBAR (Minimal styling, preserve functionality, UNIFIED BACKGROUND)
   ============================================================================ */

section[data-testid="stSidebar"] {
    background-color: var(--paper-white) !important; /* Changed from paper-bg to paper-white */
    border-right: 1px solid var(--border-light) !important;
}

section[data-testid="stSidebar"] > div:first-child {
    background-color: var(--paper-white) !important;
}

section[data-testid="stSidebar"] [data-testid="stMarkdownContainer"] {
    color: var(--text-secondary) !important;
}

/* Preserve sidebar collapse button functionality and ensure icon displays */
section[data-testid="stSidebar"] button[kind="header"],
section[data-testid="stSidebar"] button[class*="collapsedControl"] {
    all: revert !important;
}

/* Fix sidebar collapse button icon display */
section[data-testid="stSidebar"] button[kind="header"] span,
section[data-testid="stSidebar"] button[class*="collapsedControl"] span {
    font-family: 'Material Icons' !important;
    font-size: 24px !important;
    line-height: 1 !important;
    letter-spacing: normal !important;
    text-transform: none !important;
    display: inline-block !important;
    white-space: nowrap !important;
    word-wrap: normal !important;
    direction: ltr !important;
    -webkit-font-smoothing: antialiased !important;
}

/* Hide text fallback for Material Icons in sidebar */
section[data-testid="stSidebar"] button[kind="header"] span:not(.material-icons),
section[data-testid="stSidebar"] button[class*="collapsedControl"] span:not(.material-icons) {
    font-size: 0 !important;
    width: 0 !important;
    height: 0 !important;
    overflow: hidden !important;
}

/* Remove sidebar widget chrome */
section[data-testid="stSidebar"] [data-testid="stVerticalBlock"] {
    background-color: transparent !important;
    padding: 0 !important;
}

section[data-testid="stSidebar"] .stButton > button {
    background-color: var(--paper-white) !important;
    border: 1px solid var(--border-light) !important;
}

/* ============================================================================
   PLOTLY CHARTS (Clean modebar)
   ============================================================================ */

.modebar {
    background-color: var(--paper-white) !important;
    border: 1px solid var(--border-light) !important;
    border-radius: 2px !important;
    padding: 2px !important;
}

.modebar-btn path {
    fill: var(--text-secondary) !important;
}

.modebar-btn:hover path {
    fill: var(--text-primary) !important;
}

/* ============================================================================
   REGIME-SPECIFIC COLORS (Portfolio status indicators)
   ============================================================================ */

/* These are used in portfolio_risk UI for regime display */
.regime-green {
    color: var(--status-green) !important;
}

.regime-yellow {
    color: var(--status-yellow) !important;
}

.regime-red {
    color: var(--status-red) !important;
}

/* ============================================================================
   ICON TOKEN ELIMINATION (CRITICAL)
   ============================================================================ */

/* Hide any Material Icons that render as text tokens */
.material-icons,
[class*="material-icons"],
span[class*="material-icons"] {
    font-family: 'Material Icons' !important;
    /* If icon font fails to load, hide the text */
    font-size: 0 !important;
    width: 0 !important;
    height: 0 !important;
    overflow: hidden !important;
}

/* Hide any icon text fallbacks in buttons */
button span[class*="icon"],
button .material-icons-text {
    display: none !important;
}

/* Ensure sidebar collapse button uses proper icon font */
section[data-testid="stSidebar"] button[kind="header"] span {
    font-family: 'Material Icons' !important;
}

/* ============================================================================
   WIDGET CHROME REDUCTION (FINAL PASS)
   ============================================================================ */

/* Remove unnecessary padding from all containers */
div[data-testid="column"] {
    padding: 0 !important;
}

/* Remove chrome from metric containers */
div[data-testid="stMetricContainer"] {
    background-color: transparent !important;
    border: none !important;
    box-shadow: none !important;
}

/* Reduce chrome on form containers */
[data-testid="stForm"] {
    background-color: var(--paper-white) !important;
    border: 1px solid var(--border-light) !important;
    border-radius: 2px !important;
    padding: var(--spacing-md) !important;
    box-shadow: none !important;
}

/* Remove chrome from dialog containers */
[data-testid="stDialog"] {
    background-color: var(--paper-white) !important;
    border: 1px solid var(--border-medium) !important;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08) !important; /* Minimal shadow */
}

/* Reduce chrome on selectbox */
div[data-baseweb="select"] > div {
    background-color: var(--paper-white) !important;
    border: 1px solid var(--border-medium) !important;
    box-shadow: none !important;
}

/* Remove chrome from text inputs */
input[type="text"],
input[type="number"],
input[type="email"],
input[type="password"],
textarea {
    box-shadow: none !important;
    background-color: var(--paper-white) !important;
}

/* ============================================================================
   UTILITY CLASSES
   ============================================================================ */

/* Centered content */
.journal-centered {
    max-width: var(--max-content-width);
    margin: 0 auto;
    padding: 0 var(--spacing-md);
}

/* Subtle container */
.journal-container {
    background-color: var(--paper-white);
    border: 1px solid var(--border-light);
    border-radius: 2px;
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-md);
}

/* Reading width (narrower for text-heavy content) */
.journal-reading-width {
    max-width: 700px;
    margin: 0 auto;
}

/* ============================================================================
   RESPONSIVE ADJUSTMENTS
   ============================================================================ */

@media (max-width: 768px) {
    .main .block-container {
        max-width: 100% !important;
        padding-left: var(--spacing-sm) !important;
        padding-right: var(--spacing-sm) !important;
    }
    
    h1 {
        font-size: 1.75rem !important;
    }
    
    h2 {
        font-size: 1.5rem !important;
    }
    
    h3 {
        font-size: 1.25rem !important;
    }
}

/* ============================================================================
   ACCESSIBILITY (High contrast maintained)
   ============================================================================ */

/* Focus indicators */
button:focus-visible,
input:focus-visible,
textarea:focus-visible,
[role="button"]:focus-visible {
    outline: 2px solid var(--accent-color) !important;
    outline-offset: 2px !important;
}

/* Skip to content link (for screen readers) */
.skip-to-content {
    position: absolute;
    top: -40px;
    left: 0;
    background: var(--accent-color);
    color: white;
    padding: 8px;
    text-decoration: none;
    z-index: 100;
}

.skip-to-content:focus {
    top: 0;
}

/* ============================================================================
   END OF JOURNAL THEME
   ============================================================================ */

